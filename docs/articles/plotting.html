<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting • FIPS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting">
<meta property="og:description" content="FIPS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FIPS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FIPS-simulation-walkthrough.html">FIPS Simulation Walkthrough</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="plotting_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting</h1>
            
      
      
      <div class="hidden name"><code>plotting.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h2>
<p>In this vignette we briefly demonstrate how to use the FIPS plotting function. Below we create sleeptimes and simulate an example sleep scenario to plot. This example includes initial sleep deprivation.</p>
<p>(Note: you should read <code><a href="../articles/FIPS-simulation-walkthrough.html">vignette("FIPS-simulation-walkthrough","FIPS")</a></code> first).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulation start date time (i.e., when you want first predictions to begin)</span>
<span class="va">simulation.start</span> <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">'2018-05-01 11:00:00'</span>, tz <span class="op">=</span> <span class="st">"Australia/Perth"</span><span class="op">)</span>
<span class="co"># Simulation end date time (i.e., when you want predictions to end)</span>
<span class="va">simulation.end</span> <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">'2018-05-09 21:00:00'</span>, tz <span class="op">=</span> <span class="st">"Australia/Perth"</span><span class="op">)</span>
<span class="co"># Sleep times, 5 hours per night, starting 23:00</span>
<span class="va">example.sleeptimes</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  sleep.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>
    from <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">'2018-05-03 02:00:00'</span>, tz <span class="op">=</span> <span class="st">"Australia/Perth"</span><span class="op">)</span>, 
    to <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">'2018-05-09 16:00:00'</span>, tz <span class="op">=</span> <span class="st">"Australia/Perth"</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="st">'24 hours'</span><span class="op">)</span>,
  sleep.end <span class="op">=</span> <span class="va">sleep.start</span> <span class="op">+</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/duration.html" class="external-link">dhours</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,
  sleep.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">sleep.start</span><span class="op">)</span><span class="op">)</span>

<span class="va">simulated.dataframe</span> <span class="op">=</span> <span class="fu"><a href="../reference/parse_sleeptimes.html">parse_sleeptimes</a></span><span class="op">(</span>
  sleeptimes <span class="op">=</span> <span class="va">example.sleeptimes</span>,
  series.start <span class="op">=</span> <span class="va">simulation.start</span>,
  series.end <span class="op">=</span> <span class="va">simulation.end</span>,
  sleep.start.col <span class="op">=</span> <span class="st">"sleep.start"</span>,
  sleep.end.col <span class="op">=</span> <span class="st">"sleep.end"</span>,
  sleep.id.col <span class="op">=</span> <span class="st">"sleep.id"</span>,
  roundvalue <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="va">unified.simulation.results</span> <span class="op">=</span> <span class="fu"><a href="../reference/FIPS_simulate.html">FIPS_simulate</a></span><span class="op">(</span>
  FIPS_df <span class="op">=</span> <span class="va">simulated.dataframe</span>, <span class="co"># The FIPS_df</span>
  modeltype <span class="op">=</span> <span class="st">"unified"</span>,         <span class="co"># three process model</span>
  pvec <span class="op">=</span> <span class="fu"><a href="../reference/unified_make_pvec.html">unified_make_pvec</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># paramater vector</span>
  <span class="op">)</span></code></pre></div>
<p>FIPS contains a generic <code>plot</code> method for simulation results. By default this will plot fatigue over time. Sleep is indicated by the grey rectangles, and the start of each new day is indicated by the dashed lines.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">unified.simulation.results</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Often it will be helpful to restrict the plotting between certain datetimes, and plot additional data such as the model’s time-varying process estimates (e.g., c, s):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">unified.simulation.results</span>, from<span class="op">=</span><span class="st">'2018-05-03 13:30:00'</span>,
                     to <span class="op">=</span> <span class="st">"2018-05-07 18:30:00"</span>, plot_stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fatigue"</span>, <span class="st">"s"</span>, <span class="st">"c"</span>, <span class="st">"l"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Observed data can be plotted against the sleep predictions. Below demonstrates by sampling some data points from the previously generated data frame, then adding some random noise to make some ‘pretend’ observed data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">pretend_ratings</span> <span class="op">&lt;-</span> <span class="va">unified.simulation.results</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wake_status</span><span class="op">)</span> 

<span class="va">pretend_ratings</span> <span class="op">&lt;-</span> <span class="va">pretend_ratings</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pretend_ratings</span><span class="op">$</span><span class="va">datetime</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"datetime"</span>, <span class="st">"sim_hours"</span>, <span class="st">"fatigue"</span><span class="op">)</span><span class="op">]</span>

<span class="va">pretend_ratings</span><span class="op">$</span><span class="va">fatigue</span> <span class="op">&lt;-</span> <span class="va">pretend_ratings</span><span class="op">$</span><span class="va">fatigue</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pretend_ratings</span><span class="op">$</span><span class="va">fatigue</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fl">0.7</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">unified.simulation.results</span>, from<span class="op">=</span><span class="st">'2018-05-03 13:30:00'</span>,
                     to <span class="op">=</span> <span class="st">"2018-05-07 18:30:00"</span>, plot_stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fatigue"</span>, <span class="st">"s"</span>, <span class="st">"c"</span>, <span class="st">"l"</span><span class="op">)</span>,
                     fatigue_CIs <span class="op">=</span> <span class="cn">FALSE</span>, observed<span class="op">=</span><span class="va">pretend_ratings</span>, observed_y<span class="op">=</span><span class="st">"fatigue"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>Below demonstrates an example plotting the three process model. Results are similar except the output is alertness, rather than fatigue. This is automatically handled for you if you are using the generic <code>plot</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TPM.simulation.results</span> <span class="op">=</span> <span class="fu"><a href="../reference/FIPS_simulate.html">FIPS_simulate</a></span><span class="op">(</span>
  FIPS_df <span class="op">=</span> <span class="va">simulated.dataframe</span>, <span class="co"># The FIPS_df</span>
  modeltype <span class="op">=</span> <span class="st">"TPM"</span>,         <span class="co"># three process model</span>
  pvec <span class="op">=</span> <span class="fu"><a href="../reference/TPM_make_pvec.html">TPM_make_pvec</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># paramater vector</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">TPM.simulation.results</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>It is important to note that the generic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function is simply calling <code>FIPS_plot</code> under the hood. Users wishing full control may find the <code>FIPS_plot</code> function more intuitive to work with.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/FIPS_plot.html">FIPS_plot</a></span><span class="op">(</span><span class="va">TPM.simulation.results</span>, 
          plot_stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alertness"</span>, <span class="st">"c"</span>, <span class="st">"u"</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Three Process Model Simulation"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set1"</span><span class="op">)</span></code></pre></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael David Wilson, Luke Strickland, Timothy Ballard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
